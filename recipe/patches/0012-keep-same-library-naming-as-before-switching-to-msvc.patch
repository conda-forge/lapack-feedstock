From 27c8ecb686769dbcfb0b46d34547fef9d91ba55d Mon Sep 17 00:00:00 2001
From: "H. Vetinari" <h.vetinari@gmx.com>
Date: Fri, 8 Nov 2024 06:28:01 +1100
Subject: [PATCH 12/12] keep same library naming as before switching to
 msvc+flang

---
 BLAS/SRC/CMakeLists.txt       | 4 +++-
 CBLAS/src/CMakeLists.txt      | 4 +++-
 LAPACKE/CMakeLists.txt        | 1 +
 SRC/CMakeLists.txt            | 4 +++-
 TESTING/MATGEN/CMakeLists.txt | 3 +++
 5 files changed, 13 insertions(+), 3 deletions(-)

diff --git a/BLAS/SRC/CMakeLists.txt b/BLAS/SRC/CMakeLists.txt
index 7b484a8d7..6a73873f7 100644
--- a/BLAS/SRC/CMakeLists.txt
+++ b/BLAS/SRC/CMakeLists.txt
@@ -98,7 +98,9 @@ endif()
 list(REMOVE_DUPLICATES SOURCES)
 
 add_library(blas ${SOURCES})
-if(NOT APPLE)
+if(WIN32 AND NOT UNIX)
+  set_target_properties(blas PROPERTIES OUTPUT_NAME "libblas")
+elseif(NOT APPLE)
   set_target_properties(
     blas PROPERTIES
     VERSION ${LAPACK_VERSION}
diff --git a/CBLAS/src/CMakeLists.txt b/CBLAS/src/CMakeLists.txt
index 992036859..fe944b114 100644
--- a/CBLAS/src/CMakeLists.txt
+++ b/CBLAS/src/CMakeLists.txt
@@ -118,7 +118,9 @@ set_target_properties(
   cblas PROPERTIES
   LINKER_LANGUAGE C
   )
-if(NOT APPLE)
+if(WIN32 AND NOT UNIX)
+  set_target_properties(cblas PROPERTIES OUTPUT_NAME "libcblas")
+elseif(NOT APPLE)
   set_target_properties(
     cblas PROPERTIES
     VERSION ${LAPACK_VERSION}
diff --git a/LAPACKE/CMakeLists.txt b/LAPACKE/CMakeLists.txt
index 51a186e71..54af3662f 100644
--- a/LAPACKE/CMakeLists.txt
+++ b/LAPACKE/CMakeLists.txt
@@ -91,6 +91,7 @@ target_include_directories(lapacke PUBLIC
 if(WIN32 AND NOT UNIX)
   target_compile_definitions(lapacke PUBLIC HAVE_LAPACK_CONFIG_H LAPACK_COMPLEX_STRUCTURE)
   message(STATUS "Windows BUILD")
+  set_target_properties(lapacke PROPERTIES OUTPUT_NAME "liblapacke")
 endif()
 
 if(LAPACKE_WITH_TMG)
diff --git a/SRC/CMakeLists.txt b/SRC/CMakeLists.txt
index 076c979ba..83c5c73bf 100644
--- a/SRC/CMakeLists.txt
+++ b/SRC/CMakeLists.txt
@@ -501,7 +501,9 @@ endif()
 list(REMOVE_DUPLICATES SOURCES)
 
 add_library(lapack ${SOURCES})
-if(NOT APPLE)
+if(WIN32 AND NOT UNIX)
+  set_target_properties(lapack PROPERTIES OUTPUT_NAME "liblapack")
+elseif(NOT APPLE)
   set_target_properties(
     lapack PROPERTIES
     VERSION ${LAPACK_VERSION}
diff --git a/TESTING/MATGEN/CMakeLists.txt b/TESTING/MATGEN/CMakeLists.txt
index bc986da3a..f5ebf3677 100644
--- a/TESTING/MATGEN/CMakeLists.txt
+++ b/TESTING/MATGEN/CMakeLists.txt
@@ -48,5 +48,8 @@ endif()
 list(REMOVE_DUPLICATES SOURCES)
 
 add_library(tmglib ${SOURCES})
+if(WIN32 AND NOT UNIX)
+  set_target_properties(tmglib PROPERTIES OUTPUT_NAME "libtmglib")
+endif()
 target_link_libraries(tmglib ${LAPACK_LIBRARIES} ${BLAS_LIBRARIES})
 lapack_install_library(tmglib)
